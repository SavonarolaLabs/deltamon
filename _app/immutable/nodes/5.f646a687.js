import{s as je,f as k,l as U,g as w,h as I,m as K,d,j as b,k as ee,i as Y,x as o,n as re,y as De,a as z,c as j,G as B,C as Ae,D as ut,z as ue,o as ft,H as dt,B as Fe,E as Pe,e as Qe,F as Re,t as ht,p as mt}from"../chunks/scheduler.9ee62574.js";import{S as Ne,i as Se,a as J,g as Be,t as x,c as Xe,b as pe,d as ge,m as be,e as ke}from"../chunks/index.9ced2dbd.js";import{e as de,N as vt}from"../chunks/Navigation.2e767cdd.js";import{b as we}from"../chunks/paths.4ab2b2cd.js";import{g as M,s as Je,e as Ze,u as _t}from"../chunks/gameloop.45755ab9.js";import{w as ve}from"../chunks/index.54de7d24.js";const $e=ve(null),_e=1,Ve=ve(0);function pt(l){let t,e,r,s;return{c(){t=k("div"),e=k("div"),r=U(l[0]),s=U("!"),this.h()},l(a){t=w(a,"DIV",{class:!0,style:!0});var i=I(t);e=w(i,"DIV",{class:!0});var n=I(e);r=K(n,l[0]),s=K(n,"!"),n.forEach(d),i.forEach(d),this.h()},h(){b(e,"class","damage-number svelte-1wemax9"),b(t,"class","damage-number-wrapper svelte-1wemax9"),ee(t,"transform","translate("+l[2]+"px, "+l[1]+"px)")},m(a,i){Y(a,t,i),o(t,e),o(e,r),o(e,s)},p(a,[i]){i&1&&re(r,a[0])},i:De,o:De,d(a){a&&d(t)}}}function gt(l,t,e){let{damage:r=0}=t,s=(Math.random()-.5)*70,a=(Math.random()-.5)*70,i=s-20;return l.$$set=n=>{"damage"in n&&e(0,r=n.damage)},[r,a,i]}class bt extends Ne{constructor(t){super(),Se(this,t,gt,pt,je,{damage:0})}}function xe(l){let t;return{c(){t=k("div"),this.h()},l(e){t=w(e,"DIV",{class:!0}),I(t).forEach(d),this.h()},h(){b(t,"class","not-targetable-layer svelte-fua0k")},m(e,r){Y(e,t,r)},d(e){e&&d(t)}}}function et(l){let t,e,r;return e=new bt({props:{damage:l[7]}}),{c(){t=k("div"),pe(e.$$.fragment),this.h()},l(s){t=w(s,"DIV",{class:!0,style:!0});var a=I(t);ge(e.$$.fragment,a),a.forEach(d),this.h()},h(){b(t,"class","dmg-number-wrapper svelte-fua0k"),ee(t,"transform","translate("+l[5]+"px, "+l[6]+"px)")},m(s,a){Y(s,t,a),be(e,t,null),r=!0},p(s,a){const i={};a&128&&(i.damage=s[7]),e.$set(i),(!r||a&96)&&ee(t,"transform","translate("+s[5]+"px, "+s[6]+"px)")},i(s){r||(J(e.$$.fragment,s),r=!0)},o(s){x(e.$$.fragment,s),r=!1},d(s){s&&d(t),ke(e)}}}function kt(l){let t,e='<div class="flex items-center">DELTAMON</div>';return{c(){t=k("div"),t.innerHTML=e,this.h()},l(r){t=w(r,"DIV",{class:!0,"data-svelte-h":!0}),Fe(t)!=="svelte-12bz60j"&&(t.innerHTML=e),this.h()},h(){b(t,"class","logo text-green-200 text-white text-xl h-full flex flex-col justify-center items-center svelte-fua0k")},m(r,s){Y(r,t,s)},p:De,d(r){r&&d(t)}}}function wt(l){let t,e,r,s,a,i,n="HP",v,_,h;return{c(){t=k("img"),s=z(),a=k("div"),i=k("div"),i.textContent=n,v=z(),_=k("div"),h=k("div"),this.h()},l(V){t=w(V,"IMG",{class:!0,src:!0,alt:!0,width:!0}),s=j(V),a=w(V,"DIV",{class:!0});var u=I(a);i=w(u,"DIV",{style:!0,"data-svelte-h":!0}),Fe(i)!=="svelte-gk0jgf"&&(i.textContent=n),v=j(u),_=w(u,"DIV",{class:!0});var m=I(_);h=w(m,"DIV",{class:!0,style:!0}),I(h).forEach(d),m.forEach(d),u.forEach(d),this.h()},h(){b(t,"class","block mx-auto"),Pe(t.src,e=we+"/monster/"+l[0].creature.img)||b(t,"src",e),b(t,"alt",r=l[0].creature.name),b(t,"width","190"),ee(i,"font-size","8px"),ee(i,"font-weight","bold"),b(h,"class","hp-bar svelte-fua0k"),ee(h,"width",l[0].creature.hp/l[0].creature.maxHp*100+"%"),b(_,"class","hp-bar-wrapper self-center svelte-fua0k"),b(a,"class","flex justify-center gap-1")},m(V,u){Y(V,t,u),Y(V,s,u),Y(V,a,u),o(a,i),o(a,v),o(a,_),o(_,h)},p(V,u){u&1&&!Pe(t.src,e=we+"/monster/"+V[0].creature.img)&&b(t,"src",e),u&1&&r!==(r=V[0].creature.name)&&b(t,"alt",r),u&1&&ee(h,"width",V[0].creature.hp/V[0].creature.maxHp*100+"%")},d(V){V&&(d(t),d(s),d(a))}}}function It(l){var q,O;let t,e,r,s,a,i,n,v,_,h,V,u=l[0].creature&&l[2]!=0&&!((q=l[0].creature)!=null&&q.isTargetCandidate)&&!((O=l[0].creature)!=null&&O.isActive)&&xe(),m=l[4]&&et(l);function N(p,E){return p[0].creature?wt:kt}let R=N(l),y=R(l);return{c(){t=k("div"),e=k("div"),r=k("div"),s=z(),u&&u.c(),a=z(),i=k("div"),m&&m.c(),n=z(),y.c(),this.h()},l(p){t=w(p,"DIV",{style:!0,class:!0});var E=I(t);e=w(E,"DIV",{class:!0});var A=I(e);r=w(A,"DIV",{class:!0}),I(r).forEach(d),s=j(A),u&&u.l(A),a=j(A),i=w(A,"DIV",{class:!0});var W=I(i);m&&m.l(W),n=j(W),y.l(W),W.forEach(d),A.forEach(d),E.forEach(d),this.h()},h(){var p,E,A,W,X,G,g;b(r,"class","red-flash-layer svelte-fua0k"),b(i,"class","content svelte-fua0k"),b(e,"class","creature-slot border-gray-300 border border-slate-400 rounded-md svelte-fua0k"),B(e,"cursor-pointer",!l[2]&&l[0].creature),B(e,"cursor-not-allowed",l[2]==_e&&((p=l[0].creature)==null?void 0:p.playerId)==((E=M.activeCreature)==null?void 0:E.playerId)),B(e,"selected",(A=l[0].creature)==null?void 0:A.isSelected),B(e,"active",(W=l[0].creature)==null?void 0:W.isActive),B(e,"hit",l[3]),B(e,"hit-left",l[3]&&l[1]),B(e,"hit-right",l[3]&&!l[1]),B(e,"hovered-target",(X=l[0].creature)==null?void 0:X.isHoveredTarget),B(e,"empty-slot",!l[0].creature),b(t,"style",v=(G=l[0].creature)!=null&&G.isActive?"z-index:100;":"z-index:10"),b(t,"class","svelte-fua0k"),B(t,"float-animation",(g=l[0].creature)==null?void 0:g.isActive)},m(p,E){Y(p,t,E),o(t,e),o(e,r),o(e,s),u&&u.m(e,null),o(e,a),o(e,i),m&&m.m(i,null),o(i,n),y.m(i,null),_=!0,h||(V=[Ae(e,"click",l[13]),Ae(t,"mouseenter",l[14]),Ae(t,"mouseleave",l[15])],h=!0)},p(p,[E]){var A,W,X,G,g,P,F,C,ne;p[0].creature&&p[2]!=0&&!((A=p[0].creature)!=null&&A.isTargetCandidate)&&!((W=p[0].creature)!=null&&W.isActive)?u||(u=xe(),u.c(),u.m(e,a)):u&&(u.d(1),u=null),p[4]?m?(m.p(p,E),E&16&&J(m,1)):(m=et(p),m.c(),J(m,1),m.m(i,n)):m&&(Be(),x(m,1,1,()=>{m=null}),Xe()),R===(R=N(p))&&y?y.p(p,E):(y.d(1),y=R(p),y&&(y.c(),y.m(i,null))),(!_||E&5)&&B(e,"cursor-pointer",!p[2]&&p[0].creature),(!_||E&5)&&B(e,"cursor-not-allowed",p[2]==_e&&((X=p[0].creature)==null?void 0:X.playerId)==((G=M.activeCreature)==null?void 0:G.playerId)),(!_||E&1)&&B(e,"selected",(g=p[0].creature)==null?void 0:g.isSelected),(!_||E&1)&&B(e,"active",(P=p[0].creature)==null?void 0:P.isActive),(!_||E&8)&&B(e,"hit",p[3]),(!_||E&10)&&B(e,"hit-left",p[3]&&p[1]),(!_||E&10)&&B(e,"hit-right",p[3]&&!p[1]),(!_||E&1)&&B(e,"hovered-target",(F=p[0].creature)==null?void 0:F.isHoveredTarget),(!_||E&1)&&B(e,"empty-slot",!p[0].creature),(!_||E&1&&v!==(v=(C=p[0].creature)!=null&&C.isActive?"z-index:100;":"z-index:10"))&&b(t,"style",v),(!_||E&1)&&B(t,"float-animation",(ne=p[0].creature)==null?void 0:ne.isActive)},i(p){_||(J(m),_=!0)},o(p){x(m),_=!1},d(p){p&&d(t),u&&u.d(),m&&m.d(),y.d(),h=!1,ut(V)}}}function Et(l,t,e){var G;let r,s,a,i,n,v,_;ue(l,Ve,g=>e(2,s=g));let{slot:h}=t,{index:V}=t,{isTopRow:u}=t,m=((G=h.creature)==null?void 0:G.hp)??0,N=ve(!1);ue(l,N,g=>e(4,i=g));let R=ve(0);ue(l,R,g=>e(7,_=g));let y=ve(!1);ue(l,y,g=>e(3,a=g));let q=ve(0);ue(l,q,g=>e(5,n=g));let O=ve(0);ue(l,O,g=>e(6,v=g)),ft(()=>{var g;e(18,m=((g=h.creature)==null?void 0:g.hp)??0)});function p(){var g,P;if(s==_e&&h.creature&&((g=h.creature)==null?void 0:g.playerId)!=((P=M.activeCreature)==null?void 0:P.playerId)){e(0,h.creature.isHoveredTarget=!1,h),A({action:"attack",targetId:h.creature.bcId});return}h.creature&&!h.creature.isSelected&&($e.set(h.creature),M.slots.forEach(F=>{F.creature&&F!==h&&(F.creature.isSelected=!1)}))}const E=dt();function A(g){E("childUpdate",g)}function W(){var g;h.creature&&s!=0&&((g=h.creature)!=null&&g.isTargetCandidate)&&e(0,h.creature.isHoveredTarget=!0,h)}function X(){h.creature&&e(0,h.creature.isHoveredTarget=!1,h)}return l.$$set=g=>{"slot"in g&&e(0,h=g.slot),"index"in g&&e(16,V=g.index),"isTopRow"in g&&e(17,u=g.isTopRow)},l.$$.update=()=>{var g,P,F;if(l.$$.dirty&262145&&((g=h.creature)==null?void 0:g.hp)!==m){const C=m-(((P=h.creature)==null?void 0:P.hp)??0);C!==0&&(R.set(Math.abs(C)),N.set(!0),y.set(!0),q.set((Math.random()-.5)*40),O.set((Math.random()-.5)*40),setTimeout(()=>{y.set(!1)},200),setTimeout(()=>{N.set(!1)},1e3)),e(18,m=((F=h.creature)==null?void 0:F.hp)??0)}l.$$.dirty&65536&&e(1,r=V<6)},[h,r,s,a,i,n,v,_,N,R,y,q,O,p,W,X,V,u,m]}class ze extends Ne{constructor(t){super(),Se(this,t,Et,It,je,{slot:0,index:16,isTopRow:17})}}function tt(l,t,e){const r=l.slice();return r[1]=t[e],r[3]=e,r}function lt(l){let t,e,r,s=l[0].name+"",a,i,n,v,_,h,V,u,m,N,R,y,q=l[0].hp+"",O,p,E=l[0].maxHp+"",A,W,X,G=l[0].mp+"",g,P,F=l[0].maxMp+"",C,ne,se,T,oe,te=l[0].attack+"",S,f,D,c,$=l[0].defense+"",ae,he,ce,ie,fe=l[0].initiative+"",me,Z,Le=de(["Q","W","E","R"]),le=[];for(let H=0;H<4;H+=1)le[H]=rt(tt(l,Le,H));return{c(){t=k("div"),e=k("div"),r=k("div"),a=U(s),i=z(),n=k("div"),v=k("div"),_=k("img"),V=z(),u=k("div"),m=k("div");for(let H=0;H<4;H+=1)le[H].c();N=z(),R=k("div"),y=k("div"),O=U(q),p=U("/"),A=U(E),W=z(),X=k("div"),g=U(G),P=U("/"),C=U(F),ne=z(),se=k("div"),T=k("div"),oe=k("div"),S=U(te),f=U(" ATK"),D=z(),c=k("div"),ae=U($),he=U(" DEF"),ce=z(),ie=k("div"),me=U(fe),Z=U(" INI  "),this.h()},l(H){t=w(H,"DIV",{class:!0,style:!0});var Q=I(t);e=w(Q,"DIV",{class:!0});var L=I(e);r=w(L,"DIV",{class:!0,style:!0});var ye=I(r);a=K(ye,s),ye.forEach(d),i=j(L),n=w(L,"DIV",{class:!0});var Ie=I(n);v=w(Ie,"DIV",{style:!0});var Ge=I(v);_=w(Ge,"IMG",{src:!0,alt:!0}),Ge.forEach(d),V=j(Ie),u=w(Ie,"DIV",{class:!0});var Ce=I(u);m=w(Ce,"DIV",{class:!0});var Ye=I(m);for(let We=0;We<4;We+=1)le[We].l(Ye);Ye.forEach(d),N=j(Ce),R=w(Ce,"DIV",{class:!0});var Te=I(R);y=w(Te,"DIV",{class:!0});var Me=I(y);O=K(Me,q),p=K(Me,"/"),A=K(Me,E),Me.forEach(d),W=j(Te),X=w(Te,"DIV",{class:!0});var He=I(X);g=K(He,G),P=K(He,"/"),C=K(He,F),He.forEach(d),Te.forEach(d),Ce.forEach(d),ne=j(Ie),se=w(Ie,"DIV",{class:!0});var qe=I(se);T=w(qe,"DIV",{class:!0});var Ee=I(T);oe=w(Ee,"DIV",{});var Oe=I(oe);S=K(Oe,te),f=K(Oe," ATK"),Oe.forEach(d),D=j(Ee),c=w(Ee,"DIV",{});var Ue=I(c);ae=K(Ue,$),he=K(Ue," DEF"),Ue.forEach(d),ce=j(Ee),ie=w(Ee,"DIV",{});var Ke=I(ie);me=K(Ke,fe),Z=K(Ke," INI  "),Ke.forEach(d),Ee.forEach(d),qe.forEach(d),Ie.forEach(d),L.forEach(d),Q.forEach(d),this.h()},h(){b(r,"class","flex items-end text-white text-md font-bold"),ee(r,"text-shadow","2px 2px 0px black"),Pe(_.src,h=we+"/monster/"+l[0].img)||b(_,"src",h),b(_,"alt",""),ee(v,"width","130px"),b(m,"class","flex gap-2"),b(y,"class","w-full bg-green-700 text-center"),b(X,"class","w-full bg-blue-600 text-center"),b(R,"class","flex flex-col gap-1"),b(u,"class","flex flex-col gap-4"),b(T,"class","flex w-[100px] flex-col items-end"),b(se,"class","pr-2"),b(n,"class","flex gap-4 bg-gray-800"),b(e,"class","flex-flex-col"),b(t,"class","text-white z-50 w-[fit-content] fixed bottom-0 left-1/2 -translate-x-1/2"),ee(t,"z-index","2000")},m(H,Q){Y(H,t,Q),o(t,e),o(e,r),o(r,a),o(e,i),o(e,n),o(n,v),o(v,_),o(n,V),o(n,u),o(u,m);for(let L=0;L<4;L+=1)le[L]&&le[L].m(m,null);o(u,N),o(u,R),o(R,y),o(y,O),o(y,p),o(y,A),o(R,W),o(R,X),o(X,g),o(X,P),o(X,C),o(n,ne),o(n,se),o(se,T),o(T,oe),o(oe,S),o(oe,f),o(T,D),o(T,c),o(c,ae),o(c,he),o(T,ce),o(T,ie),o(ie,me),o(ie,Z)},p(H,Q){if(Q&1&&s!==(s=H[0].name+"")&&re(a,s),Q&1&&!Pe(_.src,h=we+"/monster/"+H[0].img)&&b(_,"src",h),Q&1){Le=de(["Q","W","E","R"]);let L;for(L=0;L<4;L+=1){const ye=tt(H,Le,L);le[L]?le[L].p(ye,Q):(le[L]=rt(ye),le[L].c(),le[L].m(m,null))}for(;L<4;L+=1)le[L].d(1)}Q&1&&q!==(q=H[0].hp+"")&&re(O,q),Q&1&&E!==(E=H[0].maxHp+"")&&re(A,E),Q&1&&G!==(G=H[0].mp+"")&&re(g,G),Q&1&&F!==(F=H[0].maxMp+"")&&re(C,F),Q&1&&te!==(te=H[0].attack+"")&&re(S,te),Q&1&&$!==($=H[0].defense+"")&&re(ae,$),Q&1&&fe!==(fe=H[0].initiative+"")&&re(me,fe)},d(H){H&&d(t),Re(le,H)}}}function rt(l){let t,e,r,s,a;return{c(){t=k("div"),e=k("span"),r=U(l[1]),s=z(),this.h()},l(i){t=w(i,"DIV",{class:!0,style:!0});var n=I(t);e=w(n,"SPAN",{class:!0});var v=I(e);r=K(v,l[1]),v.forEach(d),s=j(n),n.forEach(d),this.h()},h(){b(e,"class","absolute -bottom-2 bg-white px-1 text-black text-xs font-bold"),b(t,"class","relative w-[60px] h-[60px] border flex items-center justify-center"),b(t,"style",a=l[0].abilities[l[3]+1]?`background-size: contain; background-image: url(${we}/spells/${l[0].abilities[l[3]+1].icon});`:"")},m(i,n){Y(i,t,n),o(t,e),o(e,r),o(t,s)},p(i,n){n&1&&a!==(a=i[0].abilities[i[3]+1]?`background-size: contain; background-image: url(${we}/spells/${i[0].abilities[i[3]+1].icon});`:"")&&b(t,"style",a)},d(i){i&&d(t)}}}function Dt(l){let t,e=l[0]&&lt(l);return{c(){e&&e.c(),t=Qe()},l(r){e&&e.l(r),t=Qe()},m(r,s){e&&e.m(r,s),Y(r,t,s)},p(r,[s]){r[0]?e?e.p(r,s):(e=lt(r),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:De,o:De,d(r){r&&d(t),e&&e.d(r)}}}function yt(l,t,e){let r;return ue(l,$e,s=>e(0,r=s)),[r]}class Vt extends Ne{constructor(t){super(),Se(this,t,yt,Dt,je,{})}}function st(l,t,e){const r=l.slice();return r[10]=t[e],r}function at(l,t,e){const r=l.slice();return r[13]=t[e],r}function it(l,t,e){const r=l.slice();return r[13]=t[e],r}function Ct(l){let t,e="Winner: -";return{c(){t=k("p"),t.textContent=e},l(r){t=w(r,"P",{"data-svelte-h":!0}),Fe(t)!=="svelte-1rx81f4"&&(t.textContent=e)},m(r,s){Y(r,t,s)},p:De,d(r){r&&d(t)}}}function Tt(l){let t,e,r=l[0].winner.name+"",s;return{c(){t=k("p"),e=U("Winner: "),s=U(r)},l(a){t=w(a,"P",{});var i=I(t);e=K(i,"Winner: "),s=K(i,r),i.forEach(d)},m(a,i){Y(a,t,i),o(t,e),o(t,s)},p(a,i){i&1&&r!==(r=a[0].winner.name+"")&&re(s,r)},d(a){a&&d(t)}}}function nt(l){let t,e,r,s,a,i;return e=new ze({props:{slot:l[0].slots[l[13]],index:l[13],isTopRow:!0}}),e.$on("childUpdate",l[4]),s=new ze({props:{slot:l[0].slots[l[13]+1],index:l[13]+1,isTopRow:!0}}),s.$on("childUpdate",l[4]),{c(){t=k("div"),pe(e.$$.fragment),r=z(),pe(s.$$.fragment),a=z(),this.h()},l(n){t=w(n,"DIV",{class:!0});var v=I(t);ge(e.$$.fragment,v),r=j(v),ge(s.$$.fragment,v),a=j(v),v.forEach(d),this.h()},h(){b(t,"class","flex gap-2")},m(n,v){Y(n,t,v),be(e,t,null),o(t,r),be(s,t,null),o(t,a),i=!0},p(n,v){const _={};v&1&&(_.slot=n[0].slots[n[13]]),e.$set(_);const h={};v&1&&(h.slot=n[0].slots[n[13]+1]),s.$set(h)},i(n){i||(J(e.$$.fragment,n),J(s.$$.fragment,n),i=!0)},o(n){x(e.$$.fragment,n),x(s.$$.fragment,n),i=!1},d(n){n&&d(t),ke(e),ke(s)}}}function ot(l){let t,e,r,s,a,i;return e=new ze({props:{slot:l[0].slots[l[13]],index:l[13],isTopRow:!0}}),e.$on("childUpdate",l[4]),s=new ze({props:{slot:l[0].slots[l[13]+1],index:l[13]+1,isTopRow:!0}}),s.$on("childUpdate",l[4]),{c(){t=k("div"),pe(e.$$.fragment),r=z(),pe(s.$$.fragment),a=z(),this.h()},l(n){t=w(n,"DIV",{class:!0});var v=I(t);ge(e.$$.fragment,v),r=j(v),ge(s.$$.fragment,v),a=j(v),v.forEach(d),this.h()},h(){b(t,"class","flex gap-2")},m(n,v){Y(n,t,v),be(e,t,null),o(t,r),be(s,t,null),o(t,a),i=!0},p(n,v){const _={};v&1&&(_.slot=n[0].slots[n[13]]),e.$set(_);const h={};v&1&&(h.slot=n[0].slots[n[13]+1]),s.$set(h)},i(n){i||(J(e.$$.fragment,n),J(s.$$.fragment,n),i=!0)},o(n){x(e.$$.fragment,n),x(s.$$.fragment,n),i=!1},d(n){n&&d(t),ke(e),ke(s)}}}function ct(l){let t,e=l[10]+"",r;return{c(){t=k("p"),r=U(e)},l(s){t=w(s,"P",{});var a=I(t);r=K(a,e),a.forEach(d)},m(s,a){Y(s,t,a),o(t,r)},p(s,a){a&2&&e!==(e=s[10]+"")&&re(r,e)},d(s){s&&d(t)}}}function Mt(l){let t,e,r,s,a,i,n,v,_=l[0].currentRound+"",h,V,u,m,N,R,y,q,O,p,E,A,W,X;r=new vt({});function G(f,D){return f[0].winner?Tt:Ct}let g=G(l),P=g(l),F=de([0,2,4]),C=[];for(let f=0;f<3;f+=1)C[f]=nt(it(l,F,f));const ne=f=>x(C[f],1,1,()=>{C[f]=null});let se=de([6,8,10]),T=[];for(let f=0;f<3;f+=1)T[f]=ot(at(l,se,f));const oe=f=>x(T[f],1,1,()=>{T[f]=null});let te=de(l[1]),S=[];for(let f=0;f<te.length;f+=1)S[f]=ct(st(l,te,f));return E=new Vt({}),{c(){t=k("div"),e=k("div"),pe(r.$$.fragment),s=z(),a=k("div"),i=k("div"),n=k("p"),v=U("Round: "),h=U(_),V=z(),P.c(),u=z(),m=k("main"),N=k("div");for(let f=0;f<3;f+=1)C[f].c();R=z(),y=k("div");for(let f=0;f<3;f+=1)T[f].c();q=z(),O=k("div");for(let f=0;f<S.length;f+=1)S[f].c();p=z(),pe(E.$$.fragment),this.h()},l(f){t=w(f,"DIV",{class:!0,style:!0});var D=I(t);e=w(D,"DIV",{class:!0});var c=I(e);ge(r.$$.fragment,c),c.forEach(d),s=j(D),a=w(D,"DIV",{class:!0});var $=I(a);i=w($,"DIV",{style:!0,class:!0});var ae=I(i);n=w(ae,"P",{});var he=I(n);v=K(he,"Round: "),h=K(he,_),he.forEach(d),V=j(ae),P.l(ae),ae.forEach(d),u=j($),m=w($,"MAIN",{class:!0});var ce=I(m);N=w(ce,"DIV",{class:!0});var ie=I(N);for(let Z=0;Z<3;Z+=1)C[Z].l(ie);ie.forEach(d),R=j(ce),y=w(ce,"DIV",{class:!0});var fe=I(y);for(let Z=0;Z<3;Z+=1)T[Z].l(fe);fe.forEach(d),ce.forEach(d),q=j($),O=w($,"DIV",{style:!0,class:!0});var me=I(O);for(let Z=0;Z<S.length;Z+=1)S[Z].l(me);me.forEach(d),p=j($),ge(E.$$.fragment,$),$.forEach(d),D.forEach(d),this.h()},h(){b(e,"class","w-full fixed"),ee(i,"display","none"),b(i,"class","fixed top-12 left-2 bg-black bg-opacity-70 text-white p-2 w-32 z-10 flex flex-col"),b(N,"class","flex flex-col gap-2"),b(y,"class","flex flex-col gap-2"),b(m,"class","flex justify-center items-center text-sm mt-8 justify-around"),ee(O,"display","none"),b(O,"class","fixed bottom-0 w-full bg-black bg-opacity-80 text-white p-4 max-h-40 overflow-y-auto"),b(a,"class","h-full flex flex-col justify-center"),b(t,"class","h-full flex flex-col bg-arena svelte-1fv6ufs"),ee(t,"background-image","url('/bg/current.png')")},m(f,D){Y(f,t,D),o(t,e),be(r,e,null),o(t,s),o(t,a),o(a,i),o(i,n),o(n,v),o(n,h),o(i,V),P.m(i,null),o(a,u),o(a,m),o(m,N);for(let c=0;c<3;c+=1)C[c]&&C[c].m(N,null);o(m,R),o(m,y);for(let c=0;c<3;c+=1)T[c]&&T[c].m(y,null);o(a,q),o(a,O);for(let c=0;c<S.length;c+=1)S[c]&&S[c].m(O,null);l[5](O),o(a,p),be(E,a,null),A=!0,W||(X=Ae(window,"keydown",l[3]),W=!0)},p(f,[D]){if((!A||D&1)&&_!==(_=f[0].currentRound+"")&&re(h,_),g===(g=G(f))&&P?P.p(f,D):(P.d(1),P=g(f),P&&(P.c(),P.m(i,null))),D&17){F=de([0,2,4]);let c;for(c=0;c<3;c+=1){const $=it(f,F,c);C[c]?(C[c].p($,D),J(C[c],1)):(C[c]=nt($),C[c].c(),J(C[c],1),C[c].m(N,null))}for(Be(),c=3;c<3;c+=1)ne(c);Xe()}if(D&17){se=de([6,8,10]);let c;for(c=0;c<3;c+=1){const $=at(f,se,c);T[c]?(T[c].p($,D),J(T[c],1)):(T[c]=ot($),T[c].c(),J(T[c],1),T[c].m(y,null))}for(Be(),c=3;c<3;c+=1)oe(c);Xe()}if(D&2){te=de(f[1]);let c;for(c=0;c<te.length;c+=1){const $=st(f,te,c);S[c]?S[c].p($,D):(S[c]=ct($),S[c].c(),S[c].m(O,null))}for(;c<S.length;c+=1)S[c].d(1);S.length=te.length}},i(f){if(!A){J(r.$$.fragment,f);for(let D=0;D<3;D+=1)J(C[D]);for(let D=0;D<3;D+=1)J(T[D]);J(E.$$.fragment,f),A=!0}},o(f){x(r.$$.fragment,f),C=C.filter(Boolean);for(let D=0;D<3;D+=1)x(C[D]);T=T.filter(Boolean);for(let D=0;D<3;D+=1)x(T[D]);x(E.$$.fragment,f),A=!1},d(f){f&&d(t),ke(r),P.d(),Re(C,f),Re(T,f),Re(S,f),l[5](null),ke(E),W=!1,X()}}}function Ht(l){var e;const t=(e=l.activeCreature)==null?void 0:e.playerId;return console.log("setTargetableCreatures: "),l.slots.forEach(r=>{r!=null&&r.creature&&r.creature.playerId!==t?r.creature.isTargetCandidate=!0:r.creature&&(r.creature.isTargetCandidate=!1)}),l}function At(l){return l.slots.forEach(t=>{t!=null&&t.creature&&(t.creature.isTargetCandidate=!1)}),l}function Rt(l,t,e){let r;ue(l,Ve,u=>e(6,r=u));let s=[],a;function i(){document.body.style.cursor=r===_e?`url(${we}/cursor/sword.cur), auto`:"default"}function n(u){if(u.key.toLowerCase()==="a"){if(r==_e)return;Ve.set(_e),Ht(M),e(0,M),i()}else u.key==="Escape"?(r==_e?(At(M),e(0,M),Ve.set(0)):$e.set(null),i()):u.key===" "?(u.preventDefault(),M.gameOver||!M.currentRound?(Je(M),v("Match started.")):(Ze(M),v("next turn")),e(0,M),e(0,M)):u.key.toLowerCase()==="s"&&(e(0,M),e(0,M))}function v(u){e(0,M),e(1,s=[...s,u]),_()}async function _(){await ht(),a&&e(2,a.scrollTop=a.scrollHeight,a)}ft(()=>{i(),Je(M),e(0,M),$e.set(M.activeCreature)});function h(u){var N,R;const m=u.detail;if((m==null?void 0:m.action)=="attack"){const y=(N=M.activeCreature)==null?void 0:N.bcId;_t(M,y,[m.targetId],(R=M.activeCreature)==null?void 0:R.abilities[0]),Ve.set(0),i(),e(0,M),setTimeout(()=>{Ze(M),e(0,M)},800)}}function V(u){mt[u?"unshift":"push"](()=>{a=u,e(2,a)})}return[M,s,a,n,h,V]}class Lt extends Ne{constructor(t){super(),Se(this,t,Rt,Mt,je,{})}}export{Lt as component};
